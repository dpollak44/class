(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(46),c=n.n(o),s=(n(57),n(58),n(13)),l=n(2),u=n.n(l),i=n(47),m=n(51),p=n(11),h=n(4),d=n(5),f=n(7),b=n(6),v=n(8),g=(n(60),n(61),function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).addComment=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/posts/".concat(n.props.id,"/comments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n.refs.content.value})});case 3:if((t=e.sent).ok){e.next=6;break}return e.abrupt("return",console.error(t.statusText));case 6:n.complete(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),n.complete=function(){n.props.onComplete()},n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"addComment"},r.a.createElement("textarea",{ref:"content"}),r.a.createElement("button",{onClick:this.addComment},"add comment"),r.a.createElement("button",{onClick:this.complete},"cancel"))}}]),t}(a.Component)),E=(n(62),function(e){var t=e.comment;return r.a.createElement("div",{className:"comment"},r.a.createElement("h3",null,t.content),r.a.createElement("h4",null,"by ",t.author," on ",new Date(t.date).toLocaleString()))}),k=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={},n.addComment=function(){n.setState({addingComment:!n.state.addingComment})},n.commentComplete=function(){n.setState({addingComment:!1})},n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.post,t=this.state.addingComment?null:r.a.createElement("button",{className:"addComment",onClick:this.addComment},"add comment"),n=this.state.addingComment?r.a.createElement(g,{onComplete:this.commentComplete,id:e._id}):null,a=e.comments?e.comments.map((function(e,t){return r.a.createElement(E,{key:t,comment:e})})):null;return r.a.createElement("div",{className:"post",id:e._id},r.a.createElement("h2",null,e.title),r.a.createElement("h3",null,"by ",e.author," on ",new Date(e.date).toLocaleString()),r.a.createElement("div",null,e.content),r.a.createElement("div",{className:"comments"},t,n,a))}}]),t}(a.Component),O=n(48),j=n.n(O),y=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={posts:[]},n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state.posts.map((function(e){return r.a.createElement(k,{key:e._id,post:e})}));return r.a.createElement(r.a.Fragment,null,e)}},{key:"componentDidMount",value:function(){var e=Object(p.a)(u.a.mark((function e(){var t,n,a=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/posts");case 3:if((t=e.sent).ok){e.next=6;break}return e.abrupt("return",console.error(t.statusText));case 6:return e.next=8,t.json();case 8:n=e.sent,this.setState({posts:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:this.socket=j()("http://localhost"),this.socket.on("comment",(function(e){var t=Object(m.a)(a.state.posts),n=t.findIndex((function(t){return t._id===e.postId})),r=t[n]=Object(i.a)({},t[n]);r.comments=r.comments||[],r.comments.push(e.comment),a.setState({posts:t})}));case 17:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.socket.close()}}]),t}(a.Component),C=n(20),w=(n(94),function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleInputChange=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,r=t.name;n.setState(Object(C.a)({},r,a))},n.handleSubmit=function(){var e=Object(p.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n.state.title,content:n.state.content})});case 4:if((a=e.sent).ok){e.next=7;break}return e.abrupt("return",console.error(a.statusText));case 7:n.props.history.push("/"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{id:"addPost",onSubmit:this.handleSubmit},r.a.createElement("label",null,"Title:",r.a.createElement("input",{name:"title",onChange:this.handleInputChange})),r.a.createElement("label",null,"Content:",r.a.createElement("textarea",{name:"content",onChange:this.handleInputChange})),r.a.createElement("button",null,"Submit"))}}]),t}(a.Component)),x=n(16),S=(n(95),function(){return r.a.createElement("header",null,r.a.createElement("h1",null,"PCS Mongo React Socket IO Blog"),r.a.createElement("h2",null,"Welcome to the blog!"),r.a.createElement(x.b,{to:"/"},"Home")," | ",r.a.createElement(x.b,{to:"/addPost"},"Add Post"))}),T=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault()},n.handleLogin=function(){n.props.onLogin(n.refs.name.value,n.refs.password.value)},n.handleRegister=function(){n.props.onRegister(n.refs.name.value,n.refs.password.value)},n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{ref:"name",placeholder:"name"}),r.a.createElement("input",{type:"password",ref:"password",placeholder:"password"}),r.a.createElement("button",{onClick:this.handleLogin},"login"),r.a.createElement("button",{onClick:this.handleRegister},"register"))}}]),t}(a.Component),N=function(e){return r.a.createElement(r.a.Fragment,null,"Logged in as ",e.user," ",r.a.createElement("button",{onClick:e.onLogout},"logout"))},L=(n(100),function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={},n.register=function(){console.log("would register here")},n.login=function(){var e=Object(p.a)(u.a.mark((function e(t,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t,password:a})});case 3:if((r=e.sent).ok){e.next=6;break}return e.abrupt("return",console.error(r.statusText));case 6:n.setState({user:t}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),n.logout=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/logout");case 3:if((t=e.sent).ok){e.next=6;break}return e.abrupt("return",console.error(t.statusText));case 6:n.setState({user:null}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state.user?r.a.createElement(N,{user:this.state.user,onLogout:this.logout}):r.a.createElement(T,{onLogin:this.login,onRegister:this.register});return r.a.createElement("div",{className:"authenticate"},e)}}]),t}(a.Component));var P=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement(S,null),r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",exact:!0,component:y}),r.a.createElement(s.a,{path:"/addPost",exact:!0,component:w}),r.a.createElement(s.a,{render:function(e){return r.a.createElement("div",{className:"error"},"404. No such page")}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(x.a,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},52:function(e,t,n){e.exports=n(101)},57:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},91:function(e,t){},94:function(e,t,n){},95:function(e,t,n){}},[[52,1,2]]]);
//# sourceMappingURL=main.59f970b7.chunk.js.map